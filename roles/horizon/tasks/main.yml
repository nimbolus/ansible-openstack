- name: install
  yum:
    name: openstack-dashboard

- name: configure
  template:
    src: local_settings.py.j2
    dest: /etc/openstack-dashboard/local_settings
    backup: true
  notify: reload httpd

- name: request certificate
  include_role:
    name: ca
    tasks_from: req_cert.yml
  vars:
    req_name: horizon
    req_common_name: "{{ansible_fqdn}}"

- name: configure httpd
  lineinfile:
    path: /etc/httpd/conf.d/openstack-dashboard.conf
    line: WSGIApplicationGroup %{GLOBAL}
    regexp: '^WSGIApplicationGroup'
  notify: reload httpd
